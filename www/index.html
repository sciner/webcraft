<!doctype html>
<html ng-app="gameApp" lang="en">
<head>
    <meta charset="UTF-8">
	<title>MadCraft</title>
    <base href="/" target="_blank">
    <meta name="viewport" content="width=device-width, initial-scale=1.00, maximum-scale=2.50, minimum-scale=0.75">
    <link rel="shortcut icon" href="/favicon.ico" type="image/x-icon">
    <link rel="icon" type="image/png" href="/favicon.png" />
	<meta http-equiv="Content-Type" content="text/html; charset=utf-8"/>
    <meta name="description" content="Minecraft game clone on JS">
    <meta name="keywords" content="MadCraft, WebCraft, Minecraft, WebGL, WebGPU, Javascript">
    <meta property="og:title" content="MadCraft - JS game in browser">
    <meta property="og:description" content="Minecraft game clone on JS">
    <meta property="og:image" content="https://madcraft.io/media/card.webp">
    <meta property="og:site_name" content="MadCraft">
    <meta property="og:type" content="website">
    <meta property="og:url" content="https://madcraft.io">
    <meta property="twitter:card" content="summary">
    <meta property="twitter:title" content="MadCraft - JS game in browser">
    <meta property="twitter:url" content="https://madcraft.io">
    <meta property="twitter:image" content="https://madcraft.io/media/card.webp">
	<!-- Design3 -->
	<link rel="preconnect" href="https://fonts.googleapis.com">
	<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
	<!-- <link href="https://fonts.googleapis.com/css2?family=Ubuntu:wght@400;500;700&display=swap" rel="stylesheet"> -->
    <link rel="stylesheet" href="src/style/style.css">
    <script type="text/javascript" src="src/js/slim-select.js"></script>
    <link rel="stylesheet" href="../../src/style/keen-slider.min.css">
    <script src="../../src/js/keen-slider.min.js"></script>
    <script src="../../src/js/profile-page.js"></script>
    <!-- Stylesheet -->
    <link rel="stylesheet" href="vendors/animate.min.css" />
    <!-- <link rel="stylesheet" href="style/main.css" type="text/css"> -->
    <link rel="stylesheet" href="style/circles.css" />
	<!-- Third party -->
    <script src="vendors/howler.min.js" type="text/javascript"></script>
    <script src="vendors/angular.min.js"></script>
    <script src="js/ui/controller.js" type="module"></script>
    <script>
        function windowResized(event) {
            const dpr = window.devicePixelRatio;
            for(let id of ['qubatchRenderSurface', 'qubatchHUD']) {
                const c = document.getElementById(id);
                // const sz = c.parentElement.getBoundingClientRect();
                const sz = {width: c.parentElement.clientWidth, height: c.parentElement.clientHeight}
                c.width = sz.width * dpr;
                c.height = sz.height * dpr;
            }
        }
        window.addEventListener('resize', windowResized, true);
    </script>
</head>
<body oncontextmenu="return false" ng-controller="gameCtrl" ng-cloak ng-class="{logged: Qubatch && login.logged}" onload="windowResized()">

    <div id="bg-circles_area">
        <ul class="circles">
            <li></li><li></li><li></li><li></li><li></li><li></li><li></li><li></li><li></li><li></li>
        </ul>
    </div>

    <div id="qubatch-canvas-container">
        <canvas id="qubatchRenderSurface" ng-click="Qubatch.setupMousePointer(true)" width="800" height="600"></canvas>
        <canvas id="qubatchHUD" width="800" height="600"></canvas>
    </div>

    <canvas id="bg-canvas"></canvas>

    <!-- shareGame -->
    <div id="form-shareGame" class="form-normal visible_only_in_game_menu visible_in_game_menu" ng-if="shareGame.visible">
        <div>
            <span>{{Lang.share_game_with_friends}}</span>
            <button class="secondary" ng-click="shareGame.toggle()">Ã—</button>
        </div>
        <input type="text" readonly ng-value="shareGame.url">
        <button class="primary" ng-click="shareGame.copy()">{{Lang.copy}}</button>
    </div>

    <div class="start-page" ng-if="Qubatch && !login.logged">
        <input id="sign-modal-toggle" type="checkbox" class="hidden">
        <div class="bg" ng-init="initSelects()">
            <div class="container">
                <div class="block">
                    <img class="logo" src="src/img/logo.webp" alt="">
                    <div class="step-1">
                        <label for="sign-modal-toggle" class="btn primary" style="width: 210px; margin-bottom: 60px;">{{Lang.start_game}}</label>
                    </div>
                    <div class="step-2 m-auto">
                        <nav class="tabs">
                            <div class="tabs-block">
                                <label class="tab" for="tab-login">
                                    <input class="hidden toggle" id="tab-login" type="radio" name="active-tab" checked ng-model="login_tab" value="login">
                                    <span>{{Lang.login}}</span>
                                </label>
                                <label class="tab" for="tab-registration">
                                    <input class="hidden toggle" id="tab-registration" type="radio" name="active-tab" ng-model="login_tab" value="registration">
                                    <span>{{Lang.registration}}</span>
                                </label>
                            </div>
                        </nav>
                        <!-- login -->
                        <div class="animate__animated animate__fadeIn" ng-if="login_tab == 'login'">
                            <div class="border-block">
                                <input type="text" placeholder="Username" ng-model="login.form.username" my-enter="login.submit()">
                                <input type="password" placeholder="Password" ng-model="login.form.password" my-enter="login.submit()">
                                <button class="btn primary" ng-click="login.submit()" ng-class="{disabled: !login.isValid()}">{{Lang.enter}}</button>
                            </div>
                        </div>
                        <!-- registration -->
                        <div class="animate__animated animate__fadeIn" ng-if="login_tab == 'registration'">
                            <div class="border-block">
                                <input type="text" placeholder="Username" ng-model="registration.form.username" my-enter="registration.submit()">
                                <input type="password" placeholder="Password" ng-model="registration.form.password" my-enter="registration.submit()">
                                <button class="btn primary" ng-click="registration.submit()" ng-class="{disabled: !registration.isValid()}">{{Lang.enter}}</button>
                            </div>
                        </div>
                    </div>
                    <div class="social">
                        <a class="icon" href="#">
                            <img src="src/img/discord.svg" alt="">
                        </a>
                        <a class="icon" href="#">
                            <img src="src/img/youtube.svg" alt="">
                        </a>
                    </div>
                </div>
                <select class="slim-select lang-dropdown" id="start-page-select" ng-options="item as item.short_title for item in Lang.list" ng-model="current_lang" ng-change="changeLang(current_lang)"></select>
            </div>
        </div>
    </div>

	<div class="container" ng-if="Qubatch && login.logged">

        <!-- Header -->
		<header class="animate__animated animate__fadeIn">
			<nav class="tabs">
				<div class="logo cpointer" ng-click="current_window.show('main')">
					<img src="src/img/logo.webp" alt="">
				</div>
				<div class="tabs-block">
					<!-- <button class="tab">{{Lang.servers}}</button>
					<button class="tab">{{Lang.friends}}</button> -->
					<button class="tab active" href="#" ng-click="current_window.show('main')">{{Lang.worlds}}</button>
				</div>
				<div class="user-block">
					<button class="tab user" ng-click="skin.toggle()">
						<img src="media/design/icon-head.png" alt="">
						@{{Qubatch.App.session.username}}
					</button>
					<button class="tab" href="#" ng-click="settings.toggle()">
						<i class="icon-settings" style="font-size: 22px;"></i>
                    </button>
				</div>
			</nav>
		</header>

        <!-- Worlds -->
		<div class="content worlds-page animate__animated animate__fadeIn" ng-if="current_window.id == 'main'">

            <div class="grid">
				<button class="btn btn-add primary item" ng-click="newgame.open()">
					<span style="font-size: 100px;">+</span>
					<span>{{Lang.new_world_do}}</span>
                </button>
				<div class="item card __animate__animated __animate__zoomIn" ng-repeat="item in mygames.list track by item.id" ng-if="!item.hidden">
					<div class="card-body">
						<button class="btn-delete" ng-click="DeleteWorld(item.guid)">
							<i class="icon-bx_trash-alt"></i>
						</button>
						<div class="img-cover" ng-class="{with_cover: !!item.cover}">
							<h2 ng-if="!item.cover">No cover</h2>
							<p ng-if="!item.cover">Set the cover of the world in the game with the F2 key</p>
                            <img ng-if="item.cover" class="world_cover" ng-src="/worldcover/{{item.guid}}/screenshot/{{item.cover}}" alt="cover" />
						</div>
					</div>
					<div class="card-footer">
						<div class="animated-mask">
							<h2 class="m-0">{{item.title}}</h2>
							<div class="flex">
								<p class="game-mode">{{Lang.gamemode_survival}}</p>
								<div class="users-online" title="{{Lang.players_online}}">
									<i class="icon-bx-user" style="font-size: 14px; color: #AEEA00;"></i>
									<span>{{item.players_online}}</span>
								</div>
							</div>
						</div>
						<div class="buttons">
							<button class="primary" ng-click="StartWorld(item.guid)">
								<span>{{Lang.play}}</span>
								<i class="icon-arrows-right"></i>
							</button>
							<!-- <button class="secondary">Edit</button> -->
						</div>
						
					</div>
				</div>
			</div>

            <!-- Social -->
			<div class="social">
                <a class="icon" href="#">
                    <img src="src/img/discord.svg" alt="">
                </a>
                <a class="icon" href="#">
                    <img src="src/img/youtube.svg" alt="">
                </a>
            </div>

		</div>

        <!-- Settings -->
        <div class="settings-page" ng-if="texture_pack.list && current_window.id == 'settings'">

            <form class="form" ng-init="initSelects()">
                <div class="main">
                    <h1>{{Lang.main}}</h1>
                    <!-- <div class="input-group">
                        <p>Mouse Sensitivity: 30</p>
                        <div class="input-range">
                            <input type="range" min="0" value="0" max="100" step="1" >
                        </div>
                    </div>
                    <div class="input-group">
                        <p>HUD Scale: 100%</p>
                        <input type="range" min="0" value="0" max="100" step="20">
                    </div> -->
                    <div class="input-group">
                        <p>{{Lang.textures}}</p>
                        <select class="slim-select" id="settings-select-texture" ng-options="item as item.name for item in texture_pack.list" ng-model="texture_pack.current" ng-change="texture_pack.set(texture_pack.current)"></select>
                    </div>
                    <div class="input-group">
                        <p>{{Lang.language}}</p>
                        <select class="slim-select lang-dropdown" id="start-page-select" ng-options="item as item.short_title for item in Lang.list" ng-model="current_lang" ng-change="changeLang(current_lang)"></select>
                    </div>
                </div>
                <div class="video">
                    <h1>{{Lang.video}}</h1>
                    <!-- <div class="input-group">
                        <p>Render Distance: {{settings.form.render_distance}}</p>
                        <input type="range" min="2" value="{{settings.form.render_distance}}" max="16" step="1" ng-model="settings.form.render_distance">
                    </div> -->
                    <div class="input-group">
                        <p>{{Lang.render_options}}</p>
                        <div class="switcher-container">
                            <input type="checkbox" id="test1" value="" ng-model="settings.form.mipmap" />
                            <div class="switcher">
                                <small></small>
                            </div>
                            <label for="test1">{{Lang.generate_mipmap}}</label>
                        </div>
                    </div>
                    <div class="input-group">
                        <p>{{Lang.use_light}}</p>
                        <select class="slim-select" id="settings-select-light" ng-options="item as item.name for item in settings.lightMode.list" ng-model="settings.lightMode.current"></select>
                    </div>
                </div>
                <!-- <div class="audio">
                    <h1>Audio</h1>
                    <div class="input-group">
                        <p>Background Music: 30</p>
                        <input type="range" min="0" value="0" max="100" step="1">
                    </div>
                    <div class="input-group">
                        <p>Musical Devices: 70</p>
                        <input type="range" min="0" value="0" max="100" step="1">
                    </div>
                    <div class="input-group">
                        <p>Effects: 100</p>
                        <input type="range" min="0" value="0" max="100" step="1">
                    </div>
                </div> -->

                <div class="save">
                    <button class="primary" ng-click="settings.save()">{{Lang.save}}</button>
                </div>
            </form>

        </div>

        <!-- Profile -->
        <div class="profile-page" ng-if="current_window.id == 'skin'">

            <div class="content" ng-init="skin.initProfilePage()">
                <h1 class="flex items-center justify-between">
                    {{Lang.select_skin}}
                    <p class="font-m m-0" style="color: #B7B2CC;">
                        <span id="skins-current"></span>/<span id="skins-length"></span>
                    </p>
                </h1>
                <div id="skins-slider" class="keen-slider zoom-out">
                    <div class="keen-slider__slide zoom-out__slide" ng-repeat="k in skin.list">
                        <div>
                            <img ng-src="{{k.preview}}" alt="preview skin" />
                        </div>
                    </div>
                </div>
                <div class="preview-buttons">
                    <button id="slider-prev" class="slider-btn disabled" onclick="sliderPrev()">
                        <i class="icon-chevron-left"></i>
                    </button>
                    <div id="skins-preview-slider" class="keen-slider thumbnail">
                        <div class="keen-slider__slide" ng-repeat="k in skin.list"><img ng-src="{{k.preview}}"/></div>
                    </div>
                    <button id="slider-next" class="slider-btn" onclick="sliderNext()">
                        <i class="icon-chevron-right"></i>
                    </button>
                </div>
                <div class="save">
                    <button class="primary" ng-click="skin.save()">{{Lang.save}}</button>
                </div>
                <!-- <form class="form">
                    <label for="">Password</label>
                    <div class="grid">
                        <input type="text" placeholder="Current password">
                        <input type="text" placeholder="New password">
                    </div>
                    <button class="secondary" type='button'>Change password</button>
                </form> -->
            </div>
            <div class="content" style="border: none; padding-top: 10px;">
                <button class="logout" ng-click="App.logout()">
                    <i class="icon-bx-log-out"></i>
                    {{Lang.logout}}
                </button>
            </div>
            <div class="social">
                <a class="icon" href="#">
                    <img src="../../src/img/discord.svg" alt="">
                </a>
                <a class="icon" href="#">
                    <img src="../../src/img/youtube.svg" alt="">
                </a>
            </div>
        </div>

        <!-- New game -->
        <div class="create-w-page" ng-if="current_window.id == 'newgame'">
            <div class="content" ng-init="initSelects()">
                <form class="form">
                    <div class="block">
                        <h1>{{Lang.new_world}}</h1>
                        <div class="input-group">
                            <p>{{Lang.world_name}}</p>
                            <input type="text" placeholder="{{Lang.enter_world_name}}" ng-model="newgame.form.title">
                        </div>
                        <div class="grid-2 input-group">
                            <div>
                                <p>{{Lang.world_generator_type}}</p>
                                <select class="slim-select" id="create-w-select1" ng-options="item as item.title for item in newgame.generators.list" ng-model="newgame.generators.current" ng-change="newgame.generators.select(newgame.generators.current)"></select>
                                <!-- <select name="" class="slim-select" id="">
                                    <option value="{{item.id}}" ng-repeat="item in newgame.generators.list">{{item.title}}</option>
                                </select> -->
                            </div>
                            <!-- <div>
                                <p>Difficulty</p>
                                <select name="" class="slim-select" id="create-w-select2">
                                    <option value="1">Difficulty 1</option>
                                    <option value="2">Difficulty 2</option>
                                    <option value="3">Difficulty 3</option>
                                </select>
                            </div> -->
                        </div>
                        <div class="input-group">
                            <p>{{Lang.world_seed}}</p>
                            <input type="text" placeholder="" ng-model="newgame.form.seed">
                        </div>
        
                        <div class="switchers" ng-if="newgame.generators.getCurrent().has_options">
                            <p>{{Lang.world_options}}</p>
                            <!-- Options -->
                            <div ng-repeat="(key, option) in newgame.generators.getCurrent().options">
                                <!-- <button ng-if="option.type == 'select'" ng-click="newgame.generators.toggleSelect(key)">
                                    <span>{{option.title}}: {{newgame.generators.getSelectTitle(key)}}</span>
                                </button> -->
                                <div class="switcher-container" ng-if="option.type == 'checkbox'">
                                    <input type="checkbox" id="test1" value="" ng-model="newgame.form.generator.options[key]" />
                                    <div class="switcher">
                                        <small></small>
                                    </div>
                                    <label for="test1">{{option.title}}</label>
                                </div>
                            </div>

                            <!-- <div class="switcher-container">
                                <input type="checkbox" id="test1" value="" />
                                <div class="switcher">
                                    <small></small>
                                </div>
                                <label for="test1">Spawn mobs</label>
                            </div>
                            <div class="switcher-container">
                                <input type="checkbox" id="test2" value="" />
                                <div class="switcher">
                                    <small></small>
                                </div>
                                <label for="test2">PVP</label>
                            </div> -->
                        </div>
                    </div>
                    <div class="buttons">
                        <button class="primary" ng-click="newgame.submit()" ng-class="{disabled: !newgame.form.title.trim()}">{{Lang.create}}</button>
                        <button class="secondary" ng-click="newgame.close()">{{Lang.cancel}}</button>
                    </div>
                </form>
            </div>

        </div>

	</div>

    <script src="/vendors/vanilla-toast.min.js"></script>
    <div id="loading"></div>

    <div id="share-button-container">
        <button class="secondary visible_only_in_game_menu visible_in_game_menu" ng-click="shareGame.toggle()">
            <span style="margin-right: 1em;">Invite</span>
            <img src="/media/design/icons-share.svg" style="height: 2em;" alt="Invite friend">
        </button>
    </div>
    
</body>
</html>